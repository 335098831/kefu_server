{"version":3,"sources":["webpack:///./src/assets/fujian1.png","webpack:///./src/views/workorder_detail.vue?4100","webpack:///src/views/workorder_detail.vue","webpack:///./src/views/workorder_detail.vue?9869","webpack:///./src/views/workorder_detail.vue","webpack:///./src/views/workorder_detail.vue?eb69","webpack:///./src/assets/loading.gif"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","on","$event","$router","go","workorder","status","close","_v","_e","class","isShowHeader","_s","title","domProps","content","phone","email","$formatDate","create_at","typeName","staticStyle","comments","length","_l","item","index","key","aid","userInfo","avatar","a_avatar","a_nickname","request","source","isShowUploadLoading","directives","name","rawName","value","expression","inputBlur","target","composing","$set","uploadFile","reply","staticRenderFns","components","data","isSubmit","fileType","computed","console","log","e","created","document","$store","commit","methods","getWorkOrder","getComments","trim","message","setTimeout","body","scrollTo","window","fileDom","file","files","$uploadFile","secret","self","configs","upload_secret","mode","upload_mode","percent","success","html","fullPath","upload_host","src","substr","lastIndexOf","indexOf","fail","response","wid","id","del","component"],"mappings":"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","file":"js/chunk-5750b049.b7cee639.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/fujian1.083cd8b7.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[(_vm.isShowHeader)?_c('mt-header',{attrs:{\"fixed\":\"\",\"title\":\"工单详细\"}},[_c('div',{attrs:{\"slot\":\"left\"},slot:\"left\"},[_c('mt-button',{attrs:{\"icon\":\"back\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}})],1),(_vm.workorder.status != 3)?_c('mt-button',{attrs:{\"slot\":\"right\"},on:{\"click\":function($event){return _vm.close()}},slot:\"right\"},[_c('span',[_vm._v(\"关闭工单\")])]):_vm._e()],1):_vm._e(),_c('div',{staticClass:\"content\",class:{'hide-header': !_vm.isShowHeader}},[_c('div',{staticClass:\"head\"},[_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"标题：\")]),_c('span',[_vm._v(_vm._s(_vm.workorder.title))])]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"内容：\")]),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.workorder.content)}})]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"电话：\")]),_c('span',[_vm._v(_vm._s(_vm.workorder.phone || '未预留电话号码'))])]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"邮箱：\")]),_c('span',[_vm._v(_vm._s(_vm.workorder.email || '未预留邮箱'))])]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"时间：\")]),_c('span',[_vm._v(_vm._s(_vm.$formatDate(_vm.workorder.create_at)))])]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"类型：\")]),_c('span',[_vm._v(_vm._s(_vm.typeName || \"---\"))])]),_c('div',{staticClass:\"con\"},[_c('span',[_vm._v(\"状态：\")]),_c('span',[(_vm.workorder.status == 1)?_c('i',{staticStyle:{\"color\":\"#8bc34a\"}},[_vm._v(\"已回复\")]):_vm._e(),(_vm.workorder.status == 3)?_c('i',{staticStyle:{\"color\":\"#ccc\"}},[_vm._v(\"已结束\")]):_vm._e(),(_vm.workorder.status == 0)?_c('i',{staticStyle:{\"color\":\"#FF9800\"}},[_vm._v(\"待处理\")]):_vm._e(),(_vm.workorder.status == 2)?_c('i',{staticStyle:{\"color\":\"#FF9800\"}},[_vm._v(\"待回复\")]):_vm._e()])])]),_c('div',{staticClass:\"comments\"},[(_vm.comments.length <= 0)?_c('div',{staticClass:\"no-data\"},[_vm._v(\"暂无回复内容,请您耐心等待~\")]):_vm._l((_vm.comments),function(item,index){return [_c('div',{key:index,staticClass:\"item\"},[_c('div',{staticClass:\"avatar\"},[(item.aid == 0)?_c('img',{attrs:{\"src\":_vm.userInfo.avatar || 'http://qiniu.cmp520.com/avatar_degault_3.png',\"alt\":\"\"}}):_c('img',{attrs:{\"src\":item.a_avatar || 'http://qiniu.cmp520.com/avatar_degault_3.png',\"alt\":\"\"}})]),_c('div',{staticClass:\"right\"},[(item.aid == 0)?_c('div',{staticClass:\"nickname\"},[_vm._v(\"我\")]):_c('div',{staticClass:\"nickname\"},[_vm._v(_vm._s(item.a_nickname))]),_c('div',{staticClass:\"detail\",domProps:{\"innerHTML\":_vm._s(item.content)}}),_c('div',{staticClass:\"date\"},[_vm._v(_vm._s(_vm.$formatDate(item.create_at)))])])])]}),(_vm.workorder.status == 3)?_c('div',{staticClass:\"workorder-close\"},[_vm._v(\"工单已结束~\")]):_vm._e()],2),(_vm.request.source != '' || _vm.isShowUploadLoading)?_c('div',{staticClass:\"file-view\"},[(_vm.isShowUploadLoading)?_c('span',[_c('img',{attrs:{\"src\":require(\"./../assets/loading.gif\"),\"alt\":\"\"}}),_c('i',[_vm._v(\"上传中~\")])]):_c('span',[_c('img',{attrs:{\"src\":require(\"./../assets/fujian1.png\"),\"alt\":\"\"}}),_c('i',[_vm._v(\"你已成功添加附件，重新上传可替换~\")])])]):_vm._e(),(_vm.workorder.status != 3)?_c('div',{staticClass:\"input-form\"},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.request.content),expression:\"request.content\"}],attrs:{\"placeholder\":\"请输入内容~\"},domProps:{\"value\":(_vm.request.content)},on:{\"blur\":function($event){return _vm.inputBlur()},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.request, \"content\", $event.target.value)}}}),_c('span',{staticClass:\"icon-btn\"},[_c('input',{attrs:{\"title\":\"添加附件\",\"type\":\"file\",\"onclick\":\"this.value = null\"},on:{\"change\":_vm.uploadFile}})]),_c('span',{staticClass:\"sub-btn\",on:{\"click\":function($event){return _vm.reply()}}},[_vm._v(\"提交\")])]):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container\">\n    <mt-header v-if=\"isShowHeader\" fixed title=\"工单详细\">\n      <div slot=\"left\">\n        <mt-button @click=\"$router.go(-1)\" icon=\"back\"></mt-button>\n      </div>\n      <mt-button @click=\"close()\" v-if=\"workorder.status != 3\" slot=\"right\">\n        <span>关闭工单</span>\n      </mt-button>\n      <!-- <mt-button @click=\"del()\" v-else slot=\"right\">\n        <span>删除</span>\n      </mt-button> -->\n    </mt-header>\n    <div class=\"content\" :class=\"{'hide-header': !isShowHeader}\">\n      <div class=\"head\">\n        <div class=\"con\">\n          <span>标题：</span>\n          <span>{{workorder.title}}</span>\n        </div>\n        <div class=\"con\">\n          <span>内容：</span>\n          <span v-html=\"workorder.content\"></span>\n        </div>\n        <div class=\"con\">\n          <span>电话：</span>\n          <span>{{workorder.phone || '未预留电话号码'}}</span>\n        </div>\n        <div class=\"con\">\n          <span>邮箱：</span>\n          <span>{{workorder.email || '未预留邮箱'}}</span>\n        </div>\n        <div class=\"con\">\n          <span>时间：</span>\n          <span>{{$formatDate(workorder.create_at)}}</span>\n        </div>\n        <div class=\"con\">\n          <span>类型：</span>\n          <span>{{typeName || \"---\"}}</span>\n        </div>\n        <div class=\"con\">\n          <span>状态：</span>\n          <span>\n            <i v-if=\"workorder.status == 1\" style=\"color:#8bc34a;\">已回复</i>\n            <i v-if=\"workorder.status == 3\" style=\"color:#ccc\">已结束</i>\n            <i v-if=\"workorder.status == 0\" style=\"color:#FF9800\">待处理</i>\n            <i v-if=\"workorder.status == 2\" style=\"color:#FF9800\">待回复</i>\n          </span>\n        </div>\n      </div>\n      <div class=\"comments\">\n        <div class=\"no-data\" v-if=\"comments.length <= 0\">暂无回复内容,请您耐心等待~</div>\n        <template v-else v-for=\"(item,index) in comments\">\n          <div :key=\"index\" class=\"item\">\n            <div class=\"avatar\">\n              <img\n                v-if=\"item.aid == 0\"\n                :src=\"userInfo.avatar || 'http://qiniu.cmp520.com/avatar_degault_3.png'\"\n                alt\n              />\n              <img v-else :src=\"item.a_avatar || 'http://qiniu.cmp520.com/avatar_degault_3.png'\" alt />\n            </div>\n            <div class=\"right\">\n              <div class=\"nickname\" v-if=\"item.aid == 0\">我</div>\n              <div class=\"nickname\" v-else>{{item.a_nickname}}</div>\n              <div class=\"detail\" v-html=\"item.content\"></div>\n              <div class=\"date\">{{$formatDate(item.create_at)}}</div>\n            </div>\n          </div>\n        </template>\n        <div class=\"workorder-close\" v-if=\"workorder.status == 3\">工单已结束~</div>\n      </div>\n      <div class=\"file-view\" v-if=\"request.source != '' || isShowUploadLoading\">\n        <span v-if=\"isShowUploadLoading\">\n          <img src=\"./../assets/loading.gif\" alt />\n          <i>上传中~</i>\n        </span>\n        <span v-else>\n          <img src=\"./../assets/fujian1.png\" alt />\n          <i>你已成功添加附件，重新上传可替换~</i>\n        </span>\n      </div>\n      <div class=\"input-form\" v-if=\"workorder.status != 3\">\n        <textarea v-model=\"request.content\" @blur=\"inputBlur()\" placeholder=\"请输入内容~\"></textarea>\n        <span class=\"icon-btn\">\n          <input title=\"添加附件\"  type=\"file\" @change=\"uploadFile\" onclick=\"this.value = null\" />\n        </span>\n        <span class=\"sub-btn\" @click=\"reply()\">提交</span>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapGetters } from \"vuex\";\nimport { Toast, MessageBox } from \"mint-ui\";\nimport axios from \"axios\";\nexport default {\n  name: \"workorder_detail\",\n  components: {},\n  data() {\n    return {\n      isShowUploadLoading: false,\n      isSubmit: false,\n      workorder: {},\n      comments: [],\n      fileType: \"\",\n      request: {\n        source: \"\",\n        content: \"\"\n      }\n    };\n  },\n  computed: {\n    ...mapGetters([\n      \"isShowHeader\",\n      \"workorders\",\n      \"userInfo\",\n      \"workorderTypes\",\n      \"configs\"\n    ]),\n    typeName(){\n      try{\n      return this.workorderTypes.filter((i)=>i.id == this.workorder.tid)[0].title\n      }catch(e){\n        console.log(e)\n        return \"\"\n      }\n    }\n  },\n  created() {\n    document.title = \"工单详细\";\n    const id = this.$route.params.id;\n    this.$store.commit(\"updateState\", { isShowPageLoading: true });\n    axios.all([this.getWorkOrder(id), this.getComments(id)]).then(\n      axios.spread(() => {\n        this.$store.commit(\"updateState\", { isShowPageLoading: false });\n      })\n    );\n  },\n  methods: {\n    getWorkOrder(id) {\n      return axios\n        .get(\"/public/workorder/\" + id)\n        .then(response => {\n          this.workorder = response.data.data;\n          setTimeout(()=>this.$previewRefresh(), 200)\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n    getComments(id) {\n      return axios\n        .get(\"/public/workorder/comments/\" + id)\n        .then(response => {\n          if (response.data.data == null) return;\n          this.comments = response.data.data;\n          setTimeout(()=>this.$previewRefresh(), 200)\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n    reply() {\n      const content = this.request.content + this.request.source;\n      if (content.trim() == \"\") {\n        Toast({\n          message: \"请输入内容~\"\n        });\n        return;\n      }\n      if (this.isSubmit) return;\n      this.isSubmit = true;\n      const wid = this.workorder.id;\n      axios\n        .post(\"/public/workorder/reply\", { wid, content })\n        .then(response => {\n           this.isSubmit = false\n          console.log(response);\n          this.getComments(wid);\n          this.request = {\n            source: \"\",\n            content: \"\"\n          };\n          setTimeout(()=>{\n            var sBoxHeight = document.querySelector(\".container\").clientHeight\n            var sHeight = document.querySelector(\".content\").clientHeight\n            document.querySelector(\".container\").scrollTop = sHeight - sBoxHeight + 20\n          }, 500)\n        })\n        .catch(error => {\n          this.isSubmit = false\n          console.log(error);\n          Toast({\n            message: \"提交失败~\"\n          });\n        });\n    },\n    inputBlur() {\n      setTimeout(() => {\n        document.body.scrollTo = 0;\n        window.scrollTo(0, 0);\n      }, 100);\n    },\n    uploadFile(e) {\n      var fileDom = e.target;\n      var file = fileDom.files[0];\n      this.isShowUploadLoading = true;\n      const self = this;\n      this.$uploadFile({\n        file,\n        secret: self.configs.upload_secret,\n        mode: this.configs.upload_mode,\n        // 七牛才会执行\n        percent() {},\n        success(src) {\n\n          self.isShowUploadLoading = false;\n          var html\n          var fullPath = self.configs.upload_host + \"/\" + src;\n          var fileType = src.substr(src.lastIndexOf(\".\") + 1);\n          if (\"jpg,jpeg,png,JPG,JPEG,PNG\".indexOf(fileType) != -1) {\n              html = \"<br><img style='max-width:45%;margin-top:5px;' preview='1' src='\" + fullPath + \"' />\"\n          }else{\n              html = \"<br><img style='width:20px;height:20px;top:3px; right:3px;position: relative;' preview='1' src='http://qiniu.cmp520.com/fj.png' />\"\n              html += \"<a target='_blank' style='color: #2e9dfc;' href='\"+fullPath+\"'>下载附件</a>\"\n          }\n          self.request.source = html\n          Toast({\n            message: \"上传成功~\"\n          });\n        },\n        fail(e) {\n          self.isShowUploadLoading = false;\n          if (e.response && e.response.data) {\n            Toast({\n              message: e.response.data.message\n            });\n            return;\n          }\n        }\n      });\n    },\n    close() {\n      var wid = this.workorder.id;\n      MessageBox.confirm(\"您确定关闭该工单吗?\").then(() => {\n        axios\n          .put(\"/public/workorder/close/\" + wid)\n          .then(response => {\n            console.log(response);\n            Toast({\n              message: \"工单已关闭~\"\n            });\n            this.getWorkOrder(wid);\n          })\n          .catch(error => {\n            Toast({\n              message: \"工单关闭失败~\"\n            });\n            console.log(error);\n          });\n      });\n    },\n    del() {\n      var wid = this.workorder.id;\n      MessageBox.confirm(\"您确定删除该工单吗?\").then(() => {\n        axios\n          .delete(\"/public/workorder/\" + wid)\n          .then(response => {\n            console.log(response);\n            Toast({\n              message: \"工单已删除~\"\n            });\n            setTimeout(() => this.$router.go(-1));\n          })\n          .catch(error => {\n            Toast({\n              message: \"工单关闭失败~\"\n            });\n            console.log(error);\n          });\n      });\n    }\n  }\n};\n</script>\n<style lang=\"stylus\" scoped>\n.container {\n  height: 100vh;\n  overflow: hidden;\n  overflow-y: auto;\n}\n\n.content {\n  padding-top: 50px;\n  padding-bottom: 90px;\n\n  .no-data {\n    color: #666;\n    font-size: 14px;\n  }\n\n  .workorder-close {\n    text-align: center;\n    color: #666;\n    font-size: 14px;\n    padding: 10px;\n  }\n\n  &.hide-header {\n    padding-top: 0;\n  }\n\n  .head {\n    margin: 0 10px;\n    padding: 10px 0;\n    border-bottom: 1px solid rgba(158, 158, 158, 0.13);\n\n    .con {\n      font-size: 15px;\n      color: #333;\n      display: flex;\n      margin-bottom: 8px;\n\n      span {\n        flex-flow: 1;\n      }\n\n      span:first-child {\n        flex-flow: 0;\n        flex-shrink: 0;\n        width: 45px;\n      }\n\n      i {\n        font-style: normal;\n      }\n    }\n  }\n\n  .comments {\n    padding: 10px;\n\n    .item {\n      display: flex;\n\n      .avatar {\n        padding-top: 10px;\n\n        img {\n          width: 30px;\n          height: 30px;\n          border-radius: 100px;\n          display: block;\n        }\n\n        border-bottom: 1px solid rgba(158, 158, 158, 0.13);\n      }\n\n      .right {\n        padding: 10px 5px;\n        flex-grow: 1;\n        border-bottom: 1px solid rgba(158, 158, 158, 0.13);\n\n        .nickname {\n          font-size: 15px;\n          color: #333;\n        }\n\n        .detail {\n          font-size: 15px;\n          color: #333;\n          margin-top: 5px;\n        }\n\n        .date {\n          color: #999;\n          font-size: 14px;\n          margin-top: 5px;\n        }\n      }\n\n      &:last-child {\n        .right, .avatar {\n          border-bottom: 0;\n        }\n      }\n    }\n  }\n\n  .file-view {\n    position: fixed;\n    bottom: 80px;\n    left: 0;\n    right: 0;\n    padding: 5px 10px;\n    margin: 0 auto;\n    font-size: 13px;\n    color: #8bc34a;\n\n    span {\n      display: flex;\n      align-content: center;\n      align-items: center;\n\n      img {\n        width: 20px;\n        height: 20px;\n      }\n\n      i {\n        font-style: normal;\n        margin-left: 5px;\n      }\n    }\n  }\n\n  .input-form {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    margin: 0 auto;\n    width: 100%;\n    height: 80px;\n    background-color: #fff;\n    border-top: 1px solid rgba(158, 158, 158, 0.13);\n    display: flex;\n    justify-content: space-between;\n    padding: 0 10px;\n    box-sizing: border-box;\n    align-content: center;\n    align-items: center;\n\n    textarea {\n      height: 45px;\n      flex-grow: 1;\n      border-radius: 0;\n      border: 0;\n      color: #333;\n      font-size: 14px;\n      resize: none;\n    }\n\n    .icon-btn {\n      background: url('./../assets/upload.png') center center no-repeat;\n      background-size: 30px;\n      width: 55px;\n      height: 55px;\n      overflow: hidden;\n\n      input {\n        display: block;\n        width: 100%;\n        height: 100%;\n        font-size: 100px;\n        opacity: 0;\n      }\n    }\n\n    .sub-btn {\n      display: block;\n      width: 55px;\n      height: 30px;\n      color: #fff;\n      line-height: 30px;\n      text-align: center;\n      border-radius: 3px;\n      border: none;\n      font-size: 14px;\n      background: linear-gradient(to right, #26a2ff, #736cde);\n      flex-shrink: 0;\n\n      &:active {\n        opacity: 0.8;\n      }\n    }\n  }\n}\n</style>\n\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./workorder_detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./workorder_detail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./workorder_detail.vue?vue&type=template&id=35e99ebc&scoped=true&\"\nimport script from \"./workorder_detail.vue?vue&type=script&lang=js&\"\nexport * from \"./workorder_detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./workorder_detail.vue?vue&type=style&index=0&id=35e99ebc&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"35e99ebc\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./workorder_detail.vue?vue&type=style&index=0&id=35e99ebc&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./workorder_detail.vue?vue&type=style&index=0&id=35e99ebc&lang=stylus&scoped=true&\"","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7\""],"sourceRoot":""}