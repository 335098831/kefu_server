(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bf8947d"],{"11ab":function(t,e,s){},"11e9":function(t,e,s){var r=s("52a7"),o=s("4630"),a=s("6821"),n=s("6a99"),i=s("69a8"),c=s("c69a"),l=Object.getOwnPropertyDescriptor;e.f=s("9e1e")?l:function(t,e){if(t=a(t),e=n(e,!0),c)try{return l(t,e)}catch(s){}if(i(t,e))return o(!r.f.call(t,e),t[e])}},"1c01":function(t,e,s){var r=s("5ca1");r(r.S+r.F*!s("9e1e"),"Object",{defineProperty:s("86cc").f})},"42f5":function(t,e,s){},"454f":function(t,e,s){s("46a7");var r=s("584a").Object;t.exports=function(t,e,s){return r.defineProperty(t,e,s)}},"456d":function(t,e,s){var r=s("4bf8"),o=s("0d58");s("5eda")("keys",(function(){return function(t){return o(r(t))}}))},"46a7":function(t,e,s){var r=s("63b6");r(r.S+r.F*!s("8e60"),"Object",{defineProperty:s("d9f6").f})},"4f37":function(t,e,s){"use strict";s("aa77")("trim",(function(t){return function(){return t(this,3)}}))},"58b2":function(t,e,s){var r=s("5ca1");r(r.S+r.F*!s("9e1e"),"Object",{defineProperties:s("1495")})},"5eda":function(t,e,s){var r=s("5ca1"),o=s("8378"),a=s("79e5");t.exports=function(t,e){var s=(o.Object||{})[t]||Object[t],n={};n[t]=e(s),r(r.S+r.F*a((function(){s(1)})),"Object",n)}},"82f4":function(t,e,s){"use strict";var r=s("42f5"),o=s.n(r);o.a},"839b":function(t,e,s){},"85f2":function(t,e,s){t.exports=s("454f")},"8b02":function(t,e,s){},"8e6e":function(t,e,s){var r=s("5ca1"),o=s("990b"),a=s("6821"),n=s("11e9"),i=s("f1ae");r(r.S,"Object",{getOwnPropertyDescriptors:function(t){var e,s,r=a(t),c=n.f,l=o(r),u={},d=0;while(l.length>d)s=c(r,e=l[d++]),void 0!==s&&i(u,e,s);return u}})},9093:function(t,e,s){var r=s("ce10"),o=s("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},"965d":function(t,e,s){"use strict";var r=s("8b02"),o=s.n(r);o.a},"990b":function(t,e,s){var r=s("9093"),o=s("2621"),a=s("cb7c"),n=s("7726").Reflect;t.exports=n&&n.ownKeys||function(t){var e=r.f(a(t)),s=o.f;return s?e.concat(s(t)):e}},"9af4":function(t,e,s){"use strict";var r=s("839b"),o=s.n(r);o.a},aa77:function(t,e,s){var r=s("5ca1"),o=s("be13"),a=s("79e5"),n=s("fdef"),i="["+n+"]",c="​",l=RegExp("^"+i+i+"*"),u=RegExp(i+i+"*$"),d=function(t,e,s){var o={},i=a((function(){return!!n[t]()||c[t]()!=c})),l=o[t]=i?e(p):n[t];s&&(o[s]=l),r(r.P+r.F*i,"String",o)},p=d.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},ac6a:function(t,e,s){for(var r=s("cadf"),o=s("0d58"),a=s("2aba"),n=s("7726"),i=s("32e9"),c=s("84f2"),l=s("2b4c"),u=l("iterator"),d=l("toStringTag"),p=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(f),v=0;v<h.length;v++){var w,m=h[v],g=f[m],b=n[m],y=b&&b.prototype;if(y&&(y[u]||i(y,u,p),y[d]||i(y,d,m),c[m]=p,g))for(w in r)y[w]||a(y,w,r[w],!0)}},b3e0:function(t,e,s){"use strict";var r=s("11ab"),o=s.n(r);o.a},bd86:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var r=s("85f2"),o=s.n(r);function a(t,e,s){return e in t?o()(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}},d25f:function(t,e,s){"use strict";var r=s("5ca1"),o=s("0a49")(2);r(r.P+r.F*!s("2f21")([].filter,!0),"Array",{filter:function(t){return o(this,t,arguments[1])}})},df5f:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"me-head"},[s("span",[s("i",{staticClass:"el-icon-tickets"}),s("span",{attrs:{slot:"title"},slot:"title"},[t._v("工单管理")]),s("span",{staticStyle:{"font-size":"15px","margin-left":"30px",color:"#e7a646"}},[t.workOrderCounts.status0>0||t.workOrderCounts.status1?[t._v("\n           当前有： \n        ")]:t._e(),t.workOrderCounts.status0>0?[s("strong",{staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.workOrderCounts.status0))]),t._v("条待处理 ，\n        ")]:t._e(),t.workOrderCounts.status1>0?[s("strong",{staticStyle:{color:"#f56c6c"}},[t._v(" "+t._s(t.workOrderCounts.status1))]),t._v("条待回复工单 \n        ")]:t._e()],2)]),1==t.adminInfo.root?s("el-row",{staticStyle:{width:"300px"},attrs:{type:"flex",align:"middle",justify:"space-between"}},[s("div",{staticClass:"switch"},[s("el-switch",{attrs:{"inactive-color":"#cccccc","active-color":"#8bc34a","active-text":t.isOpenWorkorder?"工单功能启用中":"工单功能关闭中"},on:{change:t.changeSwitch},model:{value:t.isOpenWorkorder,callback:function(e){t.isOpenWorkorder=e},expression:"isOpenWorkorder"}}),s("div",[t._v("工单关闭后客户端无法发起工单~")])],1),s("div",[s("el-button",{attrs:{size:"mini"},on:{click:function(e){t.isShowTypesView=!0}}},[t._v("分类设置")])],1)]):t._e()],1),s("el-divider"),s("el-row",{staticClass:"container-box",attrs:{type:"flex",justify:"space-between"}},[s("div",{staticClass:"menu"},[s("el-tabs",{staticStyle:{width:"200px",height:"80vh"},attrs:{"tab-position":"left"},on:{"tab-click":t.tabsChange}},[t._l(t.workorderTypes,(function(t){return[s("el-tab-pane",{key:t.id,attrs:{label:t.title+"（"+t.count+"）"}})]}))],2)],1),s("div",{staticClass:"table-content"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.list}},[s("el-table-column",{attrs:{type:"index",index:t.indexMethod,width:"60",label:"#序号"}}),s("el-table-column",{attrs:{prop:"title",label:"工单标题"}}),s("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.workorderTypes.length-1==t.tabIndex?[s("span",{staticStyle:{color:"#f56c6b"}},[t._v("已删除")])]:[0==e.row.status?s("el-tag",{attrs:{type:"danger"}},[t._v("待客服处理")]):t._e(),1==e.row.status?s("el-tag",{attrs:{type:"warning"}},[t._v("待客服回复")]):t._e(),2==e.row.status?s("el-tag",{attrs:{type:"success"}},[t._v("客服已回复")]):t._e(),3==e.row.status?s("el-tag",{attrs:{type:"info"}},[t._v(" 工单已结束 ")]):t._e()]]}}])}),s("el-table-column",{attrs:{prop:"u_nickname",label:"用户"}}),s("el-table-column",{attrs:{prop:"a_nickname",label:"最近处理（客服）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.a_nickname||"-----")+"\n        ")]}}])}),s("el-table-column",{attrs:{prop:"create_at",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$formatUnixDate(e.row.create_at,"YYYY/MM/DD")))]}}])}),s("el-table-column",{attrs:{prop:"operating",align:"center",width:"150",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return t.onShow(e.row)}}},[t._v("查 看")])]}}])})],1),s("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"space-between"}},[s("span",{staticStyle:{color:"#666","font-size":"14px"}},[t._v("共找到"+t._s(t.tableData.total)+"条数据")]),s("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next","current-page":t.tableData.page_on,"page-sizes":[5,10,15,20],total:t.tableData.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),s("WorkOrderView",{attrs:{workorderTypes:t.workorderTypes,prop:t.showWorkOrder},model:{value:t.isShowWorkOrderView,callback:function(e){t.isShowWorkOrderView=e},expression:"isShowWorkOrderView"}}),s("WorkOrderTypesView",{attrs:{workorderTypes:t.workorderTypes},model:{value:t.isShowTypesView,callback:function(e){t.isShowTypesView=e},expression:"isShowTypesView"}})],1)},o=[],a=(s("1c01"),s("58b2"),s("8e6e"),s("f3e2"),s("d25f"),s("ac6a"),s("456d"),s("bd86")),n=s("bc3a"),i=s.n(n),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"workorder-view"},[s("div",{staticClass:"mask",on:{dblclick:t.close}}),s("transition",{attrs:{name:"el-zoom-in-bottom"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"content-box",class:{"padding-bottom30":3==t.showData.status}},[s("div",{staticClass:"title"},[s("i",{staticClass:"el-icon-tickets"}),t._v(" 工单详细\n      ")]),s("div",{staticClass:"buttons"},[1!=t.showData.status&&2!=t.showData.status||0!=t.showData.delete?t._e():s("el-button",{attrs:{size:"mini",type:"warning"},on:{click:t.closeWorkorder}},[t._v("关闭工单")]),3==t.showData.status&&1==t.adminInfo.root&&0==t.showData.delete?s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.delWorkorder}},[t._v("删除工单")]):t._e(),1==t.showData.delete?s("div",{staticStyle:{"font-size":"13px","margin-top":"5px",color:"#f44336"}},[t._v("该工单已删除")]):t._e()],1),s("span",{staticClass:"close",on:{click:t.close}},[s("i",{staticClass:"el-icon-close"})]),s("div",{staticClass:"content"},[s("div",{staticClass:"scroll"},[s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("标题：")]),s("div",{staticClass:"con"},[t._v(t._s(t.showData.title))])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("用户：")]),s("div",{staticClass:"con"},[t._v(t._s(t.showData.u_nickname))])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("手机：")]),s("div",{staticClass:"con"},[t._v(t._s(t.showData.phone))])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("邮箱：")]),s("div",{staticClass:"con"},[t._v(t._s(t.showData.email||"未预留邮箱"))])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("类型：")]),s("div",{staticClass:"con"},[t._v(t._s(t.typeName||"---"))])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("状态：")]),s("div",{staticClass:"con"},[0==t.showData.status?s("span",{staticStyle:{color:"#f56c6b"}},[t._v("待客服处理")]):t._e(),1==t.showData.status?s("span",{staticStyle:{color:"#e6a23c"}},[t._v("待客服回复")]):t._e(),2==t.showData.status?s("span",{staticStyle:{color:"#67c23a"}},[t._v("客服已回复")]):t._e(),3==t.showData.status?s("span",{staticStyle:{color:"#909399"}},[t._v("工单已结束")]):t._e()])]),s("div",{staticClass:"form-line"},[s("span",{staticClass:"lable"},[t._v("内容：")]),s("div",{staticClass:"con",domProps:{innerHTML:t._s(t.showData.content)}})]),s("el-divider",{staticStyle:{height:"10px"}}),s("div",{staticClass:"comments"},[t.comments.length<=0&&!t.isShowGetCommentsLoading?s("div",{staticClass:"no-data"},[t._v("暂无回复内容~")]):t._e(),t.isShowGetCommentsLoading?s("div",{staticClass:"comments-loading"},[s("i",{staticClass:"el-icon-loading"}),s("span",[t._v("正在努力加载中~")])]):t._l(t.comments,(function(e,r){return[s("div",{key:r,staticClass:"item"},[s("div",{staticClass:"avatar"},[e.aid==t.adminInfo.id?s("img",{attrs:{src:t.adminInfo.avatar||"http://qiniu.cmp520.com/avatar_degault_3.png",alt:""}}):s("img",{attrs:{src:e.a_avatar||"http://qiniu.cmp520.com/avatar_degault_3.png",alt:""}})]),s("div",{staticClass:"right"},[0==e.aid?s("div",{staticClass:"nickname"},[t._v(t._s(e.u_nickname))]):s("div",{staticClass:"nickname"},[t._v(t._s(e.a_nickname))]),s("div",{staticClass:"detail",domProps:{innerHTML:t._s(e.content)}}),s("div",{staticClass:"date"},[t._v(t._s(t.$formatDate(e.create_at)))])])])]})),t.showData&&3==t.showData.status?s("div",{staticClass:"workorder-close"},[t._v("工单已结束~")]):t._e()],2)],1)]),""!=t.request.source||t.isShowUploadLoading?s("div",{staticClass:"file-view"},[t.isShowUploadLoading?s("span",[s("i",{staticClass:"el-icon-loading"}),s("i",[t._v("上传中~")])]):s("span",[s("i",{staticClass:"el-icon-paperclip"}),s("i",[t._v("你已成功添加附件，重新上传可替换~")])])]):t._e(),3!=t.showData.status?s("div",{staticClass:"input-form"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.request.content,expression:"request.content"}],attrs:{placeholder:"请输入内容~"},domProps:{value:t.request.content},on:{blur:function(e){return t.inputBlur()},input:function(e){e.target.composing||t.$set(t.request,"content",e.target.value)}}}),s("span",{staticClass:"icon-btn"},[s("input",{attrs:{title:"添加附件",type:"file",onclick:"this.value = null"},on:{change:t.uploadFile}})]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.reply()}}},[t._v("提交")])],1):t._e()])])],1)},l=[],u=(s("57e7"),s("9865"),s("4f37"),s("2f62")),d=s("fb21");function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h={name:"workorder-view",data:function(){return{isShowUploadLoading:!1,isShowGetCommentsLoading:!1,isSubmit:!1,workorder:null,comments:[],fileType:"",request:{source:"",content:""}}},props:{value:{default:!1,type:Boolean},prop:Object,workorderTypes:Array},created:function(){this.comments=[]},computed:f({showData:function(){return this.workorder||this.prop},isShowAside:function(){return this.$store.state.isShowAside},typeName:function(){var t=this;try{return this.workorderTypes.filter((function(e){return e.id==t.showData.tid}))[0].title}catch(e){return""}}},Object(u["b"])(["adminInfo","configs"])),methods:{close:function(){this.$emit("input",!1)},getWorkOrder:function(){var t=this;i.a.get("/public/workorder/"+this.prop.id).then((function(e){null!=e.data.data&&(t.workorder=e.data.data),setTimeout((function(){return t.$previewRefresh()}),500)}))},getComments:function(){var t=this;this.isShowGetCommentsLoading=!0,i.a.get("/public/workorder/comments/"+this.prop.id).then((function(e){null!=e.data.data&&(t.comments=e.data.data),setTimeout((function(){return t.$previewRefresh()}),500),t.isShowGetCommentsLoading=!1})).catch((function(e){console.log(e),t.isShowGetCommentsLoading=!1,t.$message.error("加载失败，请刷新尝试~")}))},closeWorkorder:function(){var t=this;this.$prompt("请输入关闭原因！","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"关闭工单原因不能为空~"}).then((function(e){var s=e.value,r=t.showData.id,o=s;i.a.post("/workorder/close",{wid:r,remark:o}).then((function(){t.getWorkOrder(),t.$notify({title:"温馨提示！",message:"工单已关闭~",showClose:!1,type:"success"})})).catch((function(){t.$message.error("工单关闭失败~")}))}))},delWorkorder:function(){var t=this;this.$confirm("您确定删除该工单吗?","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.showData.id;i.a.delete("/public/workorder/"+e).then((function(){t.$notify({title:"温馨提示！",message:"工单已删除~",showClose:!1,type:"success"}),t.close()})).catch((function(){t.$message.error("工单删除失败~")}))}))},reply:function(){var t=this,e=this.request.content+this.request.source;if(""!=e.trim()){if(!this.isSubmit){this.isSubmit=!0;var s=this.showData.id;i.a.post("/public/workorder/reply",{wid:s,content:e}).then((function(e){t.isSubmit=!1,console.log(e),t.getComments(),t.request={source:"",content:""},t.$notify({title:"温馨提示！",message:"回复成功~",showClose:!1,type:"success"}),setTimeout((function(){var t=document.querySelector(".content").clientHeight,e=document.querySelector(".scroll").clientHeight;document.querySelector(".content").scrollTop=e-t+20}),500)})).catch((function(e){t.isSubmit=!1,console.log(e),t.$message.error("提交失败~")}))}}else this.$message.error("请输入内容~")},inputBlur:function(){setTimeout((function(){document.body.scrollTo=0,window.scrollTo(0,0)}),100)},uploadFile:function(t){var e=t.target,s=e.files[0];this.isShowUploadLoading=!0;var r=this;Object(d["a"])({file:s,mode:this.configs.upload_mode,progress:function(){},success:function(t){var e;r.isShowUploadLoading=!1;var s=r.configs.upload_host+"/"+t,o=t.substr(t.lastIndexOf(".")+1);-1!="jpg,jpeg,png,JPG,JPEG,PNG".indexOf(o)?e="<br><img style='max-width:45%;margin-top:5px;' preview='1' src='"+s+"' />":(e="<br><img style='width:20px;height:20px;top:3px; right:3px;position: relative;' preview='1' src='http://qiniu.cmp520.com/fj.png' />",e+="<a target='_blank' style='color: #2e9dfc;' href='"+s+"'>下载附件</a>"),r.request.source=e,r.$notify({title:"温馨提示！",message:"上传成功~",showClose:!1,type:"success"})},error:function(t){r.isShowUploadLoading=!1,t.response&&t.response.data&&r.$message.error(t.response.data.message)}})}},watch:{prop:function(){var t=this;this.comments=[],this.getWorkOrder(),setTimeout((function(){t.$previewRefresh(),t.getComments()}),500)}}},v=h,w=(s("b3e0"),s("2877")),m=Object(w["a"])(v,c,l,!1,null,"5cb5a4a2",null),g=m.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"workorder-view"},[s("div",{staticClass:"mask",on:{dblclick:t.close}}),s("div",{staticClass:"content-box"},[s("el-row",{staticClass:"title",attrs:{type:"flex"}},[s("span",[s("i",{staticClass:"el-icon-tickets"}),t._v(" 分类设置\n      ")]),s("div",[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.add}},[t._v("添加分类")])],1)]),s("span",{staticClass:"close",on:{click:t.close}},[s("i",{staticClass:"el-icon-close"})]),s("div",{staticClass:"content"},[s("div",{staticClass:"scroll"},[s("ul",{staticClass:"list"},[t._l(t.showWorkorderTypes,(function(e){return[s("li",{key:e.id},[s("el-row",{attrs:{type:"flex",algin:"middle"}},[s("div",[s("i",{staticClass:"el-icon-tickets"})]),s("span",[t._v(t._s(e.title))]),s("div",{staticClass:"update",on:{click:function(s){return t.update(e)}}},[s("i",{staticClass:"el-icon-edit-outline"})]),s("div",{staticClass:"del",on:{click:function(s){return t.del(e)}}},[s("i",{staticClass:"el-icon-close"})])])],1)]}))],2)])])],1)])},y=[],k={name:"workorder-view",data:function(){return{isSubmit:!1,types:null}},props:{value:{default:!1,type:Boolean},workorderTypes:Array},created:function(){this.getWorkorderTypes()},computed:{showWorkorderTypes:function(){return this.types||this.workorderTypes.slice(1,this.workorderTypes.length-2)},isShowAside:function(){return this.$store.state.isShowAside}},methods:{close:function(){this.$emit("input",!1)},getWorkorderTypes:function(){var t=this;i.a.get("/workorder/types").then((function(e){t.types=e.data.data})).catch((function(e){t.$message.error(e.response.data.message)}))},add:function(){var t=this;this.$prompt("请输入分类名称！","添加分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"分类名称不能为空~"}).then((function(e){var s=e.value;i.a.post("/workorder/type/",{title:s}).then((function(){t.getWorkorderTypes()})).catch((function(e){t.$message.error(e.response.data.message)}))}))},del:function(t){var e=this;this.$confirm("您确定删除 "+t.title+" 该分类吗?","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.a.delete("/workorder/type/"+t.id).then((function(){e.getWorkorderTypes()})).catch((function(t){e.$message.error(t.response.data.message)}))}))},update:function(t){var e=this;this.$prompt("","分类修改",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入新分类名称~",inputPattern:/\S/,inputValue:t.title,inputErrorMessage:"分类名称不能为空~"}).then((function(s){var r=s.value;r!=t.title&&i.a.put("/workorder/type/",{id:t.id,title:r}).then((function(){e.getWorkorderTypes()})).catch((function(t){e.$message.error(t.response.data.message)}))}))}},watch:{}},_=k,C=(s("965d"),Object(w["a"])(_,b,y,!1,null,"db72d194",null)),O=C.exports;function S(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function T(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?S(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):S(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var x={name:"workorder-index",components:{WorkOrderView:g,WorkOrderTypesView:O},data:function(){return{loading:!0,isShowWorkOrderView:!1,isShowTypesView:!1,showWorkOrder:{},tableData:{list:[],page_on:1,page_size:10,total:0,status:"",del:0,tid:0},tabIndex:0,del:0,isOpenWorkorder:!1,workorderTypes:[]}},computed:T({workStatus:function(){return this.tabIndex==this.workorderTypes.length-1&&this.workorderTypes.length>1?"0,1,2,3":this.tabIndex==this.workorderTypes.length-2&&this.workorderTypes.length>1?"3":"0,1,2"}},Object(u["b"])(["workOrderCounts","adminInfo","systemInfo","configs"])),created:function(){this.getWorkorderList(),this.getWorkorderTypes(),this.isOpenWorkorder=1==this.configs.open_workorder,this.$store.dispatch("ON_GET_WORKORDER_COUNTS")},methods:{onShow:function(t){this.showWorkOrder=t,this.isShowWorkOrderView=!0},tabsChange:function(t){this.tabIndex=parseInt(t.index),this.del=0,this.tabIndex==this.workorderTypes.length-1&&(this.del=1),this.changeType(this.workorderTypes[this.tabIndex].id)},changeSwitch:function(t){var e=this,s="您确定打开工单功能吗？",r=1;t||(s="您确定关闭工单功能吗？",r=0),this.$confirm(s,"温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.a.put("/system/workorder/",{open_workorder:r}).then((function(){e.$store.dispatch("ON_GET_CONFIGS")})).catch((function(t){e.$message.error(t.response.data.message)}))})).catch((function(){e.isOpenWorkorder=!e.isOpenWorkorder}))},indexMethod:function(t){return(this.tableData.page_on-1)*this.tableData.page_size+t+1},changeType:function(t){this.tableData.tid=t,this.getWorkorderList(1)},getWorkorderList:function(t){var e=this;t&&(this.tableData.page_on=t),this.tableData.status=this.workStatus,this.tableData.del=this.del;var s=this.tableData,r=s.page_on,o=s.page_size,a=s.tid,n=s.status,c=s.del;i.a.post("/workorder/list",{page_on:r,page_size:o,tid:a,status:n,del:c}).then((function(t){e.loading=!1,e.tableData=t.data.data})).catch((function(t){e.loading=!1,e.$message.error(t.response.data.message)}))},getWorkorderTypes:function(){var t=this;i.a.get("/workorder/types").then((function(e){t.workorderTypes=[{id:0,count:0,title:"全部工单"}],t.workorderTypes=t.workorderTypes.concat(e.data.data);for(var s=0;s<e.data.data.length;s++)t.workorderTypes[0].count+=e.data.data[s].count;t.workorderTypes.push({id:-1,count:t.workOrderCounts.status3,title:"已结单"}),t.workorderTypes.push({id:-2,count:t.workOrderCounts.delete_count,title:"回收站"})})).catch((function(e){t.$message.error(e.response.data.message)}))},handleSizeChange:function(t){this.tableData.page_size=t,this.getWorkorderList()},handleCurrentChange:function(t){this.tableData.page_on=t,this.getWorkorderList()}},watch:{isShowTypesView:function(t){t||(this.workorderTypes=[],this.getWorkorderTypes())},isShowWorkOrderView:function(t){t||(this.$store.dispatch("ON_GET_WORKORDER_COUNTS"),this.getWorkorderList())},systemInfo:function(){this.isOpenWorkorder=1==this.systemInfo.open_workorder}}},D=x,j=(s("9af4"),s("82f4"),Object(w["a"])(D,r,o,!1,null,"12fd5256",null));e["default"]=j.exports},f1ae:function(t,e,s){"use strict";var r=s("86cc"),o=s("4630");t.exports=function(t,e,s){e in t?r.f(t,e,o(0,s)):t[e]=s}},f3e2:function(t,e,s){"use strict";var r=s("5ca1"),o=s("0a49")(0),a=s("2f21")([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(t){return o(this,t,arguments[1])}})},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-0bf8947d.9b4903e6.js.map