(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-027be9b0"],{"467a":function(e,t,a){},"4f37":function(e,t,a){"use strict";a("aa77")("trim",(function(e){return function(){return e(this,3)}}))},"868f":function(e,t,a){"use strict";var o=a("467a"),i=a.n(o);i.a},aa77:function(e,t,a){var o=a("5ca1"),i=a("be13"),l=a("79e5"),n=a("fdef"),r="["+n+"]",s="​",c=RegExp("^"+r+r+"*"),m=RegExp(r+r+"*$"),d=function(e,t,a){var i={},r=l((function(){return!!n[e]()||s[e]()!=s})),c=i[e]=r?t(u):n[e];a&&(i[a]=c),o(o.P+o.F*r,"String",i)},u=d.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(m,"")),e};e.exports=d},aedf:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mini-im-head"},[a("span",[a("i",{staticClass:"el-icon-headset"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("客服管理")])]),1==e.adminInfo.root?a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.createDialogFormVisible=!0}}},[e._v("添 加")]):e._e()],1),a("el-divider"),a("div",{staticClass:"search"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:2.1}},[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"按关键字："}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-input",{attrs:{placeholder:"请输入关键词",clearable:"","prefix-icon":"el-icon-search"},on:{change:e.changeInput,clear:e.clearKeyword},model:{value:e.tableData.keyword,callback:function(t){e.$set(e.tableData,"keyword",t)},expression:"tableData.keyword"}})],1),a("el-col",{attrs:{span:3}},[a("el-button",{on:{click:e.search}},[e._v("查 找")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.list}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"#序号",width:"60"}}),a("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-avatar",{attrs:{size:40,src:t.row.avatar||e.$store.state.avatar}})]}}])}),a("el-table-column",{attrs:{prop:"username",label:"客服账号"}}),a("el-table-column",{attrs:{prop:"nickname",label:"客服昵称"}}),a("el-table-column",{attrs:{prop:"online",align:"center",label:"在线状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.online?a("el-tag",{attrs:{type:"success"}},[e._v("在线")]):e._e(),2==t.row.online?a("el-tag",{attrs:{type:"warning"}},[e._v("繁忙")]):e._e(),0==t.row.online?a("el-tag",{attrs:{type:"info"}},[e._v("离线")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"root",align:"center",label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.root?a("el-tag",{attrs:{effect:"dark",type:"warning"}},[e._v("超级管理")]):e._e(),0==t.row.root?a("el-tag",[e._v("客服人员")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"last_activity",label:"最后在线时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.$formatUnixDate(t.row.last_activity,"YYYY/MM/DD HH:mm"))+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"create_at",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.$formatUnixDate(t.row.create_at,"YYYY/MM/DD"))+"\n      ")]}}])}),1==e.adminInfo.root?a("el-table-column",{attrs:{prop:"operating",align:"center",width:"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.root?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编 辑")]):e._e(),0==t.row.root?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteAdmin(t.row)}}},[e._v("删 除")]):e._e()]}}],null,!1,1757062568)}):e._e()],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{color:"#666","font-size":"14px"}},[e._v("共找到"+e._s(e.tableData.total)+"条数据")]),a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next","current-page":e.tableData.page_on,"page-sizes":[5,10,15,20],total:e.tableData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("CreateDialog",{attrs:{complete:e.getAdmins,dialogFormVisible:e.createDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.createDialogFormVisible=t},"update:dialog-form-visible":function(t){e.createDialogFormVisible=t}}}),a("EditDialog",{attrs:{formData:e.editItem,complete:e.getAdmins,dialogFormVisible:e.editDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.editDialogFormVisible=t},"update:dialog-form-visible":function(t){e.editDialogFormVisible=t}}})],1)},i=[],l=(a("4f37"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",title:"添加客服","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"客服账号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入客服账号",autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"客服昵称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入客服昵称",autocomplete:"off"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("el-form-item",{attrs:{label:"登录密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入登录密码",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("el-form-item",{attrs:{label:"确认密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入确认密码",autocomplete:"off"},model:{value:e.cCassword,callback:function(t){e.cCassword=t},expression:"cCassword"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保 存")])],1)],1)}),n=[],r=a("bc3a"),s=a.n(r),c={name:"mini-im-create-admin",data:function(){return{form:{username:"",nickname:"",password:""},cCassword:"",formLabelWidth:"80px"}},props:{dialogFormVisible:Boolean,complete:Function},mounted:function(){},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var e=this;if(""!=this.form.username.trim())if(""!=this.form.nickname.trim())if(""!=this.form.password.trim())if(this.form.password.trim()==this.cCassword.trim()){var t=this.$loading({lock:!0,text:"保存中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});s.a.post("/admin",this.form).then((function(a){try{console.log(a),t.close(),e.$message.success("添加成功"),e.closeModal(),e.resize(),e.complete(1)}catch(o){console.log(o)}})).catch((function(a){t.close(),e.$message.error(a.response.data.message)}))}else this.$message.error("两次密码不一致！");else this.$message.error("密码不能为空！");else this.$message.error("昵称不能为空！");else this.$message.error("账号不能为空！")},resize:function(){this.cCassword="",this.form={username:"",nickname:"",password:""}}}},m=c,d=a("2877"),u=Object(d["a"])(m,l,n,!1,null,"56150a82",null),f=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",title:"修改客服资料","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"头像","label-width":e.formLabelWidth}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"mini-im-file-button",attrs:{title:"点击上传图片"}},[a("el-avatar",{attrs:{size:50,src:e.form.avatar||e.$store.state.avatar}}),a("input",{attrs:{onClick:"this.value = null",type:"file",accept:"image/*"},on:{change:e.changeFile}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isUploading,expression:"isUploading"}],staticClass:"mini-im-file-percent"},[a("span",[e._v(e._s(e.uploadPercent))])])],1)]),a("el-col",{attrs:{span:6}})],1)],1),a("el-form-item",{attrs:{label:"客服账号","label-width":e.formLabelWidth}},[a("span",[e._v(e._s(e.form.username))])]),a("el-form-item",{attrs:{label:"客服昵称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入客服昵称",autocomplete:"off"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("el-form-item",{attrs:{label:"手机号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入登录密码",autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"自动回复语","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入自动回复语,不支持emoji，请使用简单语句描述",autocomplete:"off"},model:{value:e.form.auto_reply,callback:function(t){e.$set(e.form,"auto_reply",t)},expression:"form.auto_reply"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保 存")])],1)],1)},g=[],b=a("fb21"),h={name:"mini-im-create-admin",data:function(){return{form:{phone:"",nickname:"",avatar:"",auto_reply:""},formLabelWidth:"90px",isUploading:!1,uploadPercent:""}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},changeFile:function(e){var t=this,a=e.target.files[0];Object(b["a"])({file:a,progress:function(e){t.isUploading=!0,t.uploadPercent=e+"%"},success:function(e){t.isUploading=!1,t.uploadPercent="",t.$message.success("上传成功");var a=t.$store.getters.configs.upload_host+"/"+e;t.form.avatar=a},error:function(e){t.isUploading=!1,t.uploadPercent="",t.$message.error(e.message)}})},save:function(){var e=this,t=this.$loading({lock:!0,text:"保存中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});s.a.put("/admin",this.form).then((function(a){try{t.close(),e.$message.success("修改成功"),e.closeModal(),e.complete(1)}catch(o){console.log(o,a)}})).catch((function(a){t.close(),e.$message.error(a.response.data.message)}))}},watch:{formData:function(){this.form=Object.assign({},this.form,this.formData)}}},v=h,w=(a("868f"),Object(d["a"])(v,p,g,!1,null,"7be8c9b2",null)),_=w.exports,k={name:"admins",components:{CreateDialog:f,EditDialog:_},data:function(){return{tableData:{list:[],page_on:1,page_size:10,keyword:"",total:0},createDialogFormVisible:!1,editDialogFormVisible:!1,loading:!0,editItem:{}}},computed:{adminInfo:function(){return this.$store.getters.adminInfo}},created:function(){var e=this;setTimeout((function(){return e.getAdmins(1)}),500)},methods:{indexMethod:function(e){return(this.tableData.page_on-1)*this.tableData.page_size+e+1},deleteAdmin:function(e){var t=this;this.$confirm("您确定要删除该客服吗? 删除后不可恢复！","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning"}).then((function(){s.a.delete("/admin/"+e.id).then((function(e){console.log(e.data),t.$message.success("删除成功"),t.getAdmins(1)})).catch((function(e){t.$message.error(e.response.data.message)}))}))},edit:function(e){this.editItem=e,this.editDialogFormVisible=!0},handleSizeChange:function(e){this.tableData.page_size=e,this.getAdmins()},handleCurrentChange:function(e){this.tableData.page_on=e,this.getAdmins()},clearKeyword:function(){this.getAdmins(1)},changeInput:function(){""==this.tableData.keyword&&this.getAdmins(1)},search:function(){this.tableData.keyword=this.tableData.keyword.trim(),this.tableData.keyword&&this.getAdmins(1)},getAdmins:function(e){var t=this;e&&(this.tableData.page_on=e);var a=this.tableData,o=a.page_on,i=a.page_size,l=a.keyword;s.a.post("/admin/list",{page_on:o,page_size:i,keyword:l,online:3}).then((function(e){t.loading=!1,t.tableData=e.data.data})).catch((function(e){t.loading=!1,t.$message.error(e.response.data.message)}))}}},y=k,D=(a("db3c"),Object(d["a"])(y,o,i,!1,null,"65c494d4",null));t["default"]=D.exports},b3a0:function(e,t,a){},db3c:function(e,t,a){"use strict";var o=a("b3a0"),i=a.n(o);i.a},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-027be9b0.82b19114.js.map